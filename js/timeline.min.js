function Rainbow(){function t(t){if(t.length<2)throw new Error("Rainbow must have two or more colours.");var i=(a-n)/(t.length-1),r=new ColourGradient;r.setGradient(t[0],t[1]),r.setNumberRange(n,n+i),e=[r];for(var s=1;s<t.length-1;s++){var l=new ColourGradient;l.setGradient(t[s],t[s+1]),l.setNumberRange(n+i*s,n+i*(s+1)),e[s]=l}return o=t,this}var e=null,n=0,a=100,o=["ff0000","ffff00","00ff00","0000ff"];t(o),this.setColors=this.setColours,this.setSpectrum=function(){return t(arguments),this},this.setSpectrumByArray=function(e){return t(e),this},this.colourAt=function(t){if(isNaN(t))throw new TypeError(t+" is not a number");if(1===e.length)return e[0].colourAt(t);var o=(a-n)/e.length,i=Math.min(Math.floor((Math.max(t,n)-n)/o),e.length-1);return e[i].colourAt(t)},this.colorAt=this.colourAt,this.setNumberRange=function(e,i){if(!(i>e))throw new RangeError("maxNumber ("+i+") is not greater than minNumber ("+e+")");return n=e,a=i,t(o),this}}function ColourGradient(){function t(t,e,n){var a=t;i>a&&(a=i),a>r&&(a=r);var o=r-i,s=parseInt(e,16),l=parseInt(n,16),d=(l-s)/o,c=Math.round(d*(a-i)+s);return formatHex(c.toString(16))}function e(t){var e=/^#?[0-9a-fA-F]{6}$/i;return e.test(t)}function n(t){if(e(t))return t.substring(t.length-6,t.length);for(var n=[["red","ff0000"],["lime","00ff00"],["blue","0000ff"],["yellow","ffff00"],["orange","ff8000"],["aqua","00ffff"],["fuchsia","ff00ff"],["white","ffffff"],["black","000000"],["gray","808080"],["grey","808080"],["silver","c0c0c0"],["maroon","800000"],["olive","808000"],["green","008000"],["teal","008080"],["navy","000080"],["purple","800080"]],a=0;a<n.length;a++)if(t.toLowerCase()===n[a][0])return n[a][1];throw new Error(t+" is not a valid colour.")}var a="ff0000",o="0000ff",i=0,r=100;this.setGradient=function(t,e){a=n(t),o=n(e)},this.setNumberRange=function(t,e){if(!(e>t))throw new RangeError("maxNumber ("+e+") is not greater than minNumber ("+t+")");i=t,r=e},this.colourAt=function(e){return t(e,a.substring(0,2),o.substring(0,2))+t(e,a.substring(2,4),o.substring(2,4))+t(e,a.substring(4,6),o.substring(4,6))},formatHex=function(t){return 1===t.length?"0"+t:t}}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,s=l.call(arguments,1),d=0,u=0,h=0,f=0,m=0,v=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(h=-1*r.detail),"wheelDelta"in r&&(h=r.wheelDelta),"wheelDeltaY"in r&&(h=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*h,h=0),d=0===h?u:h,"deltaY"in r&&(h=-1*r.deltaY,d=h),"deltaX"in r&&(u=r.deltaX,0===h&&(d=-1*u)),0!==h||0!==u){if(1===r.deltaMode){var g=t.data(this,"mousewheel-line-height");d*=g,h*=g,u*=g}else if(2===r.deltaMode){var p=t.data(this,"mousewheel-page-height");d*=p,h*=p,u*=p}if(f=Math.max(Math.abs(h),Math.abs(u)),(!i||i>f)&&(i=f,a(r,f)&&(i/=40)),a(r,f)&&(d/=40,u/=40,h/=40),d=Math[d>=1?"floor":"ceil"](d/i),u=Math[u>=1?"floor":"ceil"](u/i),h=Math[h>=1?"floor":"ceil"](h/i),c.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();m=e.clientX-w.left,v=e.clientY-w.top}return e.deltaX=u,e.deltaY=h,e.deltaFactor=i,e.offsetX=m,e.offsetY=v,e.deltaMode=0,s.unshift(e,d,u,h),o&&clearTimeout(o),o=setTimeout(n,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function n(){i=null}function a(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var o,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var d=r.length;d;)t.event.fixHooks[r[--d]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=s.length;n;)this.addEventListener(s[--n],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=s.length;n;)this.removeEventListener(s[--n],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),a=n["offsetParent"in t.fn?"offsetParent":"parent"]();return a.length||(a=t("body")),parseInt(a.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){t.fn.timeline=function(e){function n(t){var e;e=b()?20+70*Math.random()+"%":10+60*Math.random()+"%",a({content:_.templateEvent.replace("[title]",t.title).replace("[date]",m(t.date)).replace("[description]",t.description).replace(/\[link\]/g,t.link).replace("[image]",t.image?'<img src="'+t.image+'"/>':""),start:t.date.start,end:t.date.end?t.date.end:t.date.start,title:t.title,offset:e},"event"+(!0===t.keyEvent?" key-event":"")+(t.image?" has-img":"")+(t.class?" "+t.class:""))}function a(e,n,a){var r,s,l,d=p(e,a),c=H;if(b()?(r="top",s="left",l="height"):(r="left",s="top",l="width"),void 0!==a&&(c=a.find("main")),null!==d[l]){if(e.$div=t("<div></div>").appendTo(c).css(r,d[r]+("left"==r?c.scrollLeft():c.scrollTop())).css(s,e.offset?e.offset:null).css(l,d[l]).data("data",e).html("<div><h2>"+e.title+"</h2>"+(e.content?"<div>"+e.content+"</div>":"")+"</div>"),n&&e.$div.addClass(n),e.class&&e.$div.addClass(e.class),e.$div.hasClass("event"))e.$div.click(D);else switch(_.colorMode){case"rainbow":e.$div.css({backgroundColor:"rainbow"==_.colorMode?N():E()});break;case"random":e.$div.css({backgroundColor:E()})}e.interval&&o(e),i(e.$div)}}function o(e){if(e.interval){var n=_.layoutMode==O?"height":"width",a=_.layoutMode==O?"top":"left",o=t('<ul class="scale"></ul>').css(n,"width"==n?e.$div.width():e.$div.height()).appendTo(e.$div);t(e.interval).each(function(n,r){var s=t("<li></li>").css(a,"left"==a?g(r)-e.$div.offset().left:g(r)-e.$div.offset().top).html(h(r)).appendTo(o);i(s)})}}function i(t){t.data("originalStyle",{height:t.height(),left:y(t)?t.offset().left+t.parent().scrollLeft():t.position().left,top:y(t)?t.offset().top+t.parent().scrollTop():t.position().top,width:t.width()})}function r(){B.find(".event").unbind().remove(),_.data=[]}function s(t){var e=parseInt(t),n=t-e,a=e%4==0&&e%100!=0||e%400==0?366:365,o=n*a*24*60*60*1e3,i=new Date(e,0,1);return i=new Date(i.getTime()+o),{year:e,month:i.getMonth()+1,day:i.getDate()}}function l(){var e=this;return null===_.layoutMode&&(_.layoutMode=B.height()>B.width()?O:I),B.addClass(_.layoutMode===O?"vertical":"horizontal"),B.addClass("loading"),M(),_.data&&(t(_.data).each(function(t,e){n(e)}),B.removeClass("loading")),t(_.src).each(function(t,n){setTimeout(function(){C.call(e,n)},500*t)}),this}function d(e,n){var a=!0;return t.each(["day","month","year"],function(t,o){return e[o]!=n[o]?(a=!1,void 0):void 0}),a}function c(t,e,n){var a=void 0!==t.year?t.year:t,o=void 0!==e.year?e.year:e,i=void 0!==n.year?n.year:n;return a>=o&&i>=a}function u(t){window.console&&window.console.log&&window.console.log(t)}function h(t){if(!t.year)return f(t);if(t.format)return t.format.replace("y",t.year).replace("m",_.monthNames[t.month-1]).replace("d",t.day);var e=f(t.year);return t.month&&(e=_.monthNames[t.month-1]+" "+e),t.day&&(e=t.day+" "+e),e}function f(t){var e=t;return Math.abs(t)>=1e6?e=(Math.abs(t/1e6).toFixed(1)+"m yrs").replace(".0",""):Math.abs(t)>1e4&&(e=T(Math.abs(t))),0>t&&(e+=" BC"),e}function m(t){var e=[h(t.start)];return t.end&&(d(t.start,t.end)||e.push(h(t.end))),e.join(" to ")}function v(e){var n=b()?"top":"left",a=b()?"height":"width",o={};return t(_.timescales).each(function(t,i){var r=i.$div.position()[n],l=r+i.$div[a]();if(e>=r&&r+l>=e){var d=(e-r)/(l-r),c=i.end-i.start;return o.year=i.start+c*d,o.year<1e3?o.string=h(o.year.toFixed(0)):o.year&&(o.string=h(s(o.year))),void 0}}),o}function g(e){var n,a=e.year?e.year:e,o=b()?"top":"left";return e.month&&e.day?a=365*a+30*e.month+e.day:e.month&&(a=12*a+e.month),t(_.timescales).each(function(t,i){var r=i.start,s=i.end;e.month&&e.day?(r*=365,s*=365):e.month&&(r*=12,s*=12);var l=i.width/(s-r);return a>=r&&s>a?(n=i.$div.offset()[o]+(a-r)*l,n*P):void 0}),n}function p(e,n){var a={left:null,width:0},o=_.timescales,i=e.start.year?e.start.year:e.start,r=e.end.year?e.end.year:e.end,s=b()?"top":"left";return e.start.month&&e.start.day&&(i=365*i+30*e.start.month+e.start.day,r=365*r+30*e.end.month+e.end.day),void 0!==n&&(o=[{$div:n,start:n.data("data").start,end:n.data("data").end,width:n.width()}]),t(o).each(function(t,n){var o=n.start,l=n.end;e.start.month&&e.start.day&&(o*=365,l*=365);var d=n.width/(l-o);i>=o&&l>i&&(a[s]=n.$div.position()[s]+(i-o)*d),i>l||o>r||(i>o&&l>r?a.width+=(r-i)*d:i>=o&&r>=l?a.width+=(l-i)*d:o>i&&r>l?a.width+=n.width:o>=i&&l>=r&&(a.width+=(r-o)*d))}),a}function w(t){return t.data("originalStyle")}function y(t){return t.hasClass("event")}function b(){return _.layoutMode===O}function M(){F(_.layoutMode);var e=b()?"top":"left",n=b()?"height":"width";G.setNumberRange(0,_.timescales.length),_.colors&&G.setSpectrumByArray(_.colors),H=t("<main></main>").appendTo(B),t(_.timescales).each(function(a,r){_.timescales[a][e]=0===a?0:H.children().last().position()[e]+("left"===e?H.children().last().width():H.children().last().height()),_.timescales[a].$div=t('<div class="timespan"><h1>'+f(r.start)+"</h1></div>").addClass(r.class).appendTo(H).css("backgroundColor","rainbow"===_.colorMode?"#"+G.colorAt(a):N()).css(e,_.timescales[a][e]).css(n,r.width).data("data",r),i(_.timescales[a].$div),o(_.timescales[a])}),t(_.periods).each(function(t,e){e.class=e.class?"period "+e.class:"period",a(e)}),_.startDate&&Y(_.startDate),H.mousedown(x).keydown(L).keyup($).mousewheel(function(t){t.preventDefault(),X(100*t.deltaY)}).attr("tabindex",1).focus().find(">div").dblclick(z),t(window).resize(function(){})}function C(t){t.loadFunction&&t.url?t.loadFunction.call(this,t.url,this):_.loadFunction?_.loadFunction.call(this,t,this):k(t)}function k(e,a){B.addClass("loading"),t.ajax({dataType:"json",success:function(e){t(e).each(function(t,e){n(e)}),_.data=_.data.concat(e),B.removeClass("loading"),void 0!==a&&a()},url:e})}function T(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function x(e){var n,a,o=this;b()?(n=e.clientY,a=H.scrollTop(),H.mousemove(function(t){H.scrollTop(a-(t.clientY-n))}).mouseup(function(e){t(e.currentTarget).unbind("mousemove").unbind("mouseup")}),_.onMove.call(o)):(n=e.clientX,a=H.scrollLeft(),H.mousemove(function(t){H.scrollLeft(a-(t.clientX-n))}).mouseup(function(e){t(e.currentTarget).unbind("mousemove").unbind("mouseup")}),_.onMove.call(o))}function D(e){var n=t(e.currentTarget),a=n.closest("main"),o=n.offset().left,i=a.width()<o+n.find("h2").width(),r=a.height()/2<n.offset().top;n.removeClass("right").removeClass("bottom").toggleClass("active"),i&&n.addClass("right"),r&&n.addClass("bottom"),Y(n.data("data").start)}function L(t){if(b())switch(t.keyCode){case 38:R(H.height()/4);break;case 40:R(-H.height()/4)}else switch(t.keyCode){case 37:R(H.width()/4);break;case 39:R(-H.width()/4)}}function $(t){}function S(e){var n=t(e.currentTarget).closest(".clone");t(".clone").css({left:-1+H.scrollLeft(),position:"absolute"}).animate({height:n.data("owner").height(),left:n.data("owner").offset().left+H.scrollLeft(),opacity:0,top:n.data("owner").offset().top,width:n.data("owner").width()},function(){n.remove(),B.removeClass("zoomed")})}function z(e){if(_.enableRegionExpand){t(".clone button").trigger("click");var n=t(e.currentTarget),o=n.clone(!0).css({backgroundColor:""}).attr("tabindex",1).addClass("clone").removeClass("rotate").unbind().appendTo(H).animate({height:B.height(),left:-1+H.scrollLeft(),top:0,width:B.width()+2},function(){B.addClass("zoomed"),t(this).css({left:-1,position:"fixed"}),u(_.data),t(_.data).each(function(t,e){c(e.date.start,o.data("data").start,o.data("data").end)&&a({content:_.templateEvent.replace("[title]",e.title).replace("[date]",m(e.date)).replace("[description]",e.description).replace(/\[link\]/g,e.link).replace("[image]",e.image?'<img src="'+e.image+'"/>':""),start:e.date.start,end:e.date.end?e.date.end:e.date.start,title:e.title,offset:10+50*Math.random()+"%"},"event"+(!0===e.keyEvent?" key-event":"")+(e.image?" has-img":""),o)})}).data("owner",n).append(t("<button></button>").click(S)).prepend("<main></main>").keydown(A).focus(),i=o.find("ul").width();o.find("ul").css({width:"100%"}).children().each(function(e,n){t(n).css({left:100*(t(n).position().left/i)+"%"})}),n.data("data").name&&n.data("data").start&&n.data("data").end&&(o.append('<div class="label start">'+f(n.data("data").start)+"</div>"),o.append('<div class="label end">'+f(n.data("data").end)+"</div>")),_dragging=!1}}function A(t){switch(t.keyCode){case 27:S(t)}}function E(){for(var t=[],e=0;2>=e;e++)t.push(Math.round(255*Math.random()));return"rgba("+t.join(",")+",0.5)"}function N(){return"rgba(0,0,0,"+(0+.1*Math.random())+")"}function R(t){_.layoutMode==O?H.stop().animate({scrollTop:H.scrollTop()-t}):H.stop().animate({scrollLeft:H.scrollLeft()-t}),_.onMove.call(this)}function F(t){var e=_.layoutMode;t!==O&&(t=I),t!==e&&(u(t),_clear(),l())}function X(t){_.layoutMode==O?H.scrollTop(H.scrollTop()-t):H.scrollLeft(H.scrollLeft()-t),_.onMove.call(this)}function Y(t){var e;_.layoutMode==O?(e=B.parent().width()/2-g(t),R(e)):(e=B.parent().height()/2-g(t),R(e)),_.onMove.call(this)}function j(e){var n=_._zoomFactor;P=e,H.find(">div, .scale li").each(function(n,a){var o=w(t(a)),i=b()?{height:o.height*e,top:o.top*e,transition:"height "+_.zoomSpeed+"s, top "+_.zoomSpeed+"s"}:{left:o.left*e,transition:"left "+_.zoomSpeed+"s, width "+_.zoomSpeed+"s",width:o.width*e};t(a).css(i)}),H.scrollLeft(H.scrollLeft()*e),_.onZoom.call(this,n,e)}var H,I=0,O=1,B=t(this),G=new Rainbow,P=1,_=t.extend({colorMode:"",data:[],layoutMode:null,monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],onMove:function(){},onZoom:function(){},src:[],templateEvent:'<span class="date">[date]</span><span class="description">[image][description]</span><a href="[link]" target="_blank">More...</a>',zoomSpeed:.05},e);return this.each(function(){l.call(this),this.addItem=function(e){e=t.extend({title:"",description:"",date:{start:{year:null,month:null,day:null},end:{year:null,month:null,day:null}},link:"",image:"","class":"",keyEvent:!1,top:null},e),n(e),_.data.push(e)},this.clearFeatures=function(){r(this)},this.getDateAtXY=function(t,e){return b()?v(e):v(t)},this.gotoDate=function(t){Y(t)},this.loadData=function(t){C.call(this,t)},this.zoom=function(t){j.call(this,t)}})}}(jQuery);
//# sourceMappingURL=timeline.min.js.map