function Rainbow(){function t(t){if(t.length<2)throw new Error("Rainbow must have two or more colours.");var o=(a-n)/(t.length-1),r=new ColourGradient;r.setGradient(t[0],t[1]),r.setNumberRange(n,n+o),e=[r];for(var s=1;s<t.length-1;s++){var l=new ColourGradient;l.setGradient(t[s],t[s+1]),l.setNumberRange(n+o*s,n+o*(s+1)),e[s]=l}return i=t,this}var e=null,n=0,a=100,i=["ff0000","ffff00","00ff00","0000ff"];t(i),this.setColors=this.setColours,this.setSpectrum=function(){return t(arguments),this},this.setSpectrumByArray=function(e){return t(e),this},this.colourAt=function(t){if(isNaN(t))throw new TypeError(t+" is not a number");if(1===e.length)return e[0].colourAt(t);var i=(a-n)/e.length,o=Math.min(Math.floor((Math.max(t,n)-n)/i),e.length-1);return e[o].colourAt(t)},this.colorAt=this.colourAt,this.setNumberRange=function(e,o){if(!(o>e))throw new RangeError("maxNumber ("+o+") is not greater than minNumber ("+e+")");return n=e,a=o,t(i),this}}function ColourGradient(){function t(t,e,n){var a=t;o>a&&(a=o),a>r&&(a=r);var i=r-o,s=parseInt(e,16),l=parseInt(n,16),d=(l-s)/i,c=Math.round(d*(a-o)+s);return formatHex(c.toString(16))}function e(t){var e=/^#?[0-9a-fA-F]{6}$/i;return e.test(t)}function n(t){if(e(t))return t.substring(t.length-6,t.length);for(var n=[["red","ff0000"],["lime","00ff00"],["blue","0000ff"],["yellow","ffff00"],["orange","ff8000"],["aqua","00ffff"],["fuchsia","ff00ff"],["white","ffffff"],["black","000000"],["gray","808080"],["grey","808080"],["silver","c0c0c0"],["maroon","800000"],["olive","808000"],["green","008000"],["teal","008080"],["navy","000080"],["purple","800080"]],a=0;a<n.length;a++)if(t.toLowerCase()===n[a][0])return n[a][1];throw new Error(t+" is not a valid colour.")}var a="ff0000",i="0000ff",o=0,r=100;this.setGradient=function(t,e){a=n(t),i=n(e)},this.setNumberRange=function(t,e){if(!(e>t))throw new RangeError("maxNumber ("+e+") is not greater than minNumber ("+t+")");o=t,r=e},this.colourAt=function(e){return t(e,a.substring(0,2),i.substring(0,2))+t(e,a.substring(2,4),i.substring(2,4))+t(e,a.substring(4,6),i.substring(4,6))},formatHex=function(t){return 1===t.length?"0"+t:t}}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,s=l.call(arguments,1),d=0,u=0,f=0,h=0,m=0,v=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(f=-1*r.detail),"wheelDelta"in r&&(f=r.wheelDelta),"wheelDeltaY"in r&&(f=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*f,f=0),d=0===f?u:f,"deltaY"in r&&(f=-1*r.deltaY,d=f),"deltaX"in r&&(u=r.deltaX,0===f&&(d=-1*u)),0!==f||0!==u){if(1===r.deltaMode){var g=t.data(this,"mousewheel-line-height");d*=g,f*=g,u*=g}else if(2===r.deltaMode){var p=t.data(this,"mousewheel-page-height");d*=p,f*=p,u*=p}if(h=Math.max(Math.abs(f),Math.abs(u)),(!o||o>h)&&(o=h,a(r,h)&&(o/=40)),a(r,h)&&(d/=40,u/=40,f/=40),d=Math[d>=1?"floor":"ceil"](d/o),u=Math[u>=1?"floor":"ceil"](u/o),f=Math[f>=1?"floor":"ceil"](f/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();m=e.clientX-w.left,v=e.clientY-w.top}return e.deltaX=u,e.deltaY=f,e.deltaFactor=o,e.offsetX=m,e.offsetY=v,e.deltaMode=0,s.unshift(e,d,u,f),i&&clearTimeout(i),i=setTimeout(n,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function n(){o=null}function a(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var i,o,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var d=r.length;d;)t.event.fixHooks[r[--d]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=s.length;n;)this.addEventListener(s[--n],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=s.length;n;)this.removeEventListener(s[--n],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),a=n["offsetParent"in t.fn?"offsetParent":"parent"]();return a.length||(a=t("body")),parseInt(a.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){t.fn.timeline=function(e){function n(e,n,i){var o=f(e,i),r=N;if(void 0!==i&&(r=i.find("main")),null!==o.left){if(e.$div=t("<div></div>").appendTo(r).css({left:o.left+r.scrollLeft(),top:e.top?e.top:null,width:o.width}).data("data",e).html("<h2>"+e.title+"</h2>"+(e.content?"<div>"+e.content+"</div>":"")).click(p),n&&e.$div.addClass(n),e.class&&e.$div.addClass(e.class),!e.$div.hasClass("event"))switch($.colorMode){case"rainbow":e.$div.css({backgroundColor:"rainbow"==$.colorMode?x():k()});break;case"random":e.$div.css({backgroundColor:k()})}e.interval&&a(e)}}function a(e){if(e.interval){var n=t('<ul class="scale"></ul>').css({width:e.$div.width()}).appendTo(e.$div);t(e.interval).each(function(a,i){n.append(t("<li></li>").css({left:u(i)-e.$div.offset().left}).html(s(i)))})}}function i(){var e=this;return A.addClass("loading"),h(),$.data&&(t($.data).each(function(t,e){v(e)}),A.removeClass("loading")),t($.src).each(function(t,n){setTimeout(function(){n.loadFunction&&n.url?n.loadFunction.call(e,n.url,e):$.loadFunction?$.loadFunction.call(e,n,e):m(n)},500*t)}),this}function o(e,n){var a=!0;return t.each(["day","month","year"],function(t,i){return e[i]!=n[i]?(a=!1,void 0):void 0}),a}function r(t,e,n){var a=void 0!==t.year?t.year:t,i=void 0!==e.year?e.year:e,o=void 0!==n.year?n.year:n;return a>=i&&o>=a}function s(t){if(!t.year)return l(t);if(t.format)return t.format.replace("y",t.year).replace("m",$.monthNames[t.month-1]).replace("d",t.day);var e=l(t.year);return t.month&&(e=$.monthNames[t.month-1]+" "+e),t.day&&(e=t.day+" "+e),e}function l(t){var e=t;return Math.abs(t)>=1e6?e=(Math.abs(t/1e6).toFixed(1)+"m yrs").replace(".0",""):Math.abs(t)>1e4&&(e=d(Math.abs(t))),0>t&&(e+=" BC"),e}function d(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function c(t){var e=[s(t.start)];return t.end&&(o(t.start,t.end)||e.push(s(t.end))),e.join(" to ")}function u(e){var n,a=e.year?e.year:e;return e.month&&e.day?a=365*a+30*e.month+e.day:e.month&&(a=12*a+e.month),t($.timescales).each(function(t,i){var o=i.start,r=i.end;e.month&&e.day?(o*=365,r*=365):e.month&&(o*=12,r*=12);var s=i.width/(r-o);return a>=o&&r>a?(n=i.$div.offset().left+(a-o)*s,void 0):void 0}),n}function f(e,n){var a={left:null,width:0},i=$.timescales,o=e.start.year?e.start.year:e.start,r=e.end.year?e.end.year:e.end;return e.start.month&&e.start.day&&(o=365*o+30*e.start.month+e.start.day,r=365*r+30*e.end.month+e.end.day),void 0!==n&&(i=[{$div:n,start:n.data("data").start,end:n.data("data").end,width:n.width()}]),t(i).each(function(t,n){var i=n.start,s=n.end;e.start.month&&e.start.day&&(i*=365,s*=365);var l=n.width/(s-i);o>=i&&s>o&&(a.left=n.$div.position().left+(o-i)*l),o>s||i>r||(o>i&&s>r?a.width+=(r-o)*l:o>=i&&r>=s?a.width+=(s-o)*l:i>o&&r>s?a.width+=n.width:i>=o&&s>=r&&(a.width+=(r-i)*l))}),a}function h(){R.setNumberRange(0,$.timescales.length),$.colors&&R.setSpectrumByArray($.colors),N=t("<main></main>").appendTo(A),t($.timescales).each(function(e,n){$.timescales[e].left=0==e?0:N.children().last().position().left+N.children().last().width(),$.timescales[e].$div=t('<div class="timespan"><h1>'+l(n.start)+"</h1></div>").addClass(n.class).appendTo(N).css({backgroundColor:"rainbow"==$.colorMode?"#"+R.colorAt(e):x(),left:$.timescales[e].left,width:n.width}).data("data",n),a($.timescales[e])}),t($.periods).each(function(t,e){e.class=e.class?"period "+e.class:"period",n(e)}),$.startDate&&E($.startDate),N.mousedown(g).keydown(w).keyup(y).mousewheel(function(t){t.preventDefault(),D(100*t.deltaY)}).attr("tabindex",1).focus().find(">div").dblclick(M)}function m(e,n){A.addClass("loading"),t.ajax({dataType:"json",success:function(e){t(e).each(function(t,e){v(e)}),$.data=$.data.concat(e),A.removeClass("loading"),void 0!=n&&n()},url:e})}function v(t){var e;e=10+60*Math.random()+"%",n({content:$.templateEvent.replace("[title]",t.title).replace("[date]",c(t.date)).replace("[description]",t.description).replace(/\[link\]/g,t.link).replace("[image]",t.image?'<img src="'+t.image+'"/>':""),start:t.date.start,end:t.date.end?t.date.end:t.date.start,title:t.title,top:e},"event"+(!0===t.keyEvent?" key-event":"")+(t.image?" has-img":"")+(t.class?" "+t.class:""))}function g(e){var n=e.clientX,a=N.scrollLeft();N.mousemove(function(t){N.scrollLeft(a-(t.clientX-n))}).mouseup(function(e){t(e.currentTarget).unbind("mousemove").unbind("mouseup")})}function p(e){var n=t(e.currentTarget),a=n.closest("main"),i=a.width()-a.scrollLeft()<n.offset().left+n.find("h2").width(),o=a.height()/2<n.offset().top;n.removeClass("right").removeClass("bottom").toggleClass("active"),i&&n.addClass("right"),o&&n.addClass("bottom")}function w(t){switch(t.keyCode){case 37:L(N.width()/4);break;case 39:L(-N.width()/4)}}function y(t){}function b(e){var n=t(e.currentTarget).closest(".clone");t(".clone").css({left:-1+N.scrollLeft(),position:"absolute"}).animate({height:n.data("owner").height(),left:n.data("owner").offset().left+N.scrollLeft(),opacity:0,top:n.data("owner").offset().top,width:n.data("owner").width()},function(){n.remove(),A.removeClass("zoomed")})}function M(e){if($.enableRegionExpand){t(".clone button").trigger("click");var a=t(e.currentTarget),i=a.clone(!0).css({backgroundColor:""}).attr("tabindex",1).addClass("clone").removeClass("rotate").unbind().appendTo(N).animate({height:A.height(),left:-1+N.scrollLeft(),top:0,width:A.width()+2},function(){A.addClass("zoomed"),t(this).css({left:-1,position:"fixed"}),t($.data).each(function(t,e){r(e.date.start,i.data("data").start,i.data("data").end)&&n({content:$.templateEvent.replace("[title]",e.title).replace("[date]",c(e.date)).replace("[description]",e.description).replace(/\[link\]/g,e.link).replace("[image]",e.image?'<img src="'+e.image+'"/>':""),start:e.date.start,end:e.date.end?e.date.end:e.date.start,title:e.title,top:10+50*Math.random()+"%"},"event"+(!0===e.keyEvent?" key-event":"")+(e.image?" has-img":""),i)})}).data("owner",a).append(t("<button></button>").click(b)).prepend("<main></main>").keydown(C).focus(),o=i.find("ul").width();i.find("ul").css({width:"100%"}).children().each(function(e,n){t(n).css({left:100*(t(n).position().left/o)+"%"})}),a.data("data").name&&a.data("data").start&&a.data("data").end&&(i.append('<div class="label start">'+l(a.data("data").start)+"</div>"),i.append('<div class="label end">'+l(a.data("data").end)+"</div>")),T=!1}}function C(t){switch(t.keyCode){case 27:b(t)}}function k(){for(var t=[],e=0;2>=e;e++)t.push(Math.round(255*Math.random()));return"rgba("+t.join(",")+",0.5)"}function x(){return"rgba(0,0,0,"+(0+.1*Math.random())+")"}function L(t){N.stop().animate({scrollLeft:N.scrollLeft()-t})}function D(t){N.scrollLeft(N.scrollLeft()-t)}function E(t){var e=A.parent().width()/2-u(t);L(e)}var N,A=t(this),T=!1,R=new Rainbow,$=t.extend({colorMode:"",data:[],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],src:[],templateEvent:'<span class="date">[date]</span><span class="description">[image][description]</span><a href="[link]" target="_blank">More...</a>'},e);return this.each(function(){i.call(this),this.addItem=function(e){e=t.extend({title:"",description:"",date:{start:{year:null,month:null,day:null},end:{year:null,month:null,day:null}},link:"",image:"","class":"",keyEvent:!1,top:null},e),v(e)},this.gotoDate=function(t){E(t)}})}}(jQuery);
//# sourceMappingURL=timeline.min.js.map