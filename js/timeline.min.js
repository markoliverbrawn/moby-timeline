function Rainbow(){function t(t){if(t.length<2)throw new Error("Rainbow must have two or more colours.");var i=(a-n)/(t.length-1),r=new ColourGradient;r.setGradient(t[0],t[1]),r.setNumberRange(n,n+i),e=[r];for(var s=1;s<t.length-1;s++){var l=new ColourGradient;l.setGradient(t[s],t[s+1]),l.setNumberRange(n+i*s,n+i*(s+1)),e[s]=l}return o=t,this}var e=null,n=0,a=100,o=["ff0000","ffff00","00ff00","0000ff"];t(o),this.setColors=this.setColours,this.setSpectrum=function(){return t(arguments),this},this.setSpectrumByArray=function(e){return t(e),this},this.colourAt=function(t){if(isNaN(t))throw new TypeError(t+" is not a number");if(1===e.length)return e[0].colourAt(t);var o=(a-n)/e.length,i=Math.min(Math.floor((Math.max(t,n)-n)/o),e.length-1);return e[i].colourAt(t)},this.colorAt=this.colourAt,this.setNumberRange=function(e,i){if(!(i>e))throw new RangeError("maxNumber ("+i+") is not greater than minNumber ("+e+")");return n=e,a=i,t(o),this}}function ColourGradient(){function t(t,e,n){var a=t;i>a&&(a=i),a>r&&(a=r);var o=r-i,s=parseInt(e,16),l=parseInt(n,16),d=(l-s)/o,c=Math.round(d*(a-i)+s);return formatHex(c.toString(16))}function e(t){var e=/^#?[0-9a-fA-F]{6}$/i;return e.test(t)}function n(t){if(e(t))return t.substring(t.length-6,t.length);for(var n=[["red","ff0000"],["lime","00ff00"],["blue","0000ff"],["yellow","ffff00"],["orange","ff8000"],["aqua","00ffff"],["fuchsia","ff00ff"],["white","ffffff"],["black","000000"],["gray","808080"],["grey","808080"],["silver","c0c0c0"],["maroon","800000"],["olive","808000"],["green","008000"],["teal","008080"],["navy","000080"],["purple","800080"]],a=0;a<n.length;a++)if(t.toLowerCase()===n[a][0])return n[a][1];throw new Error(t+" is not a valid colour.")}var a="ff0000",o="0000ff",i=0,r=100;this.setGradient=function(t,e){a=n(t),o=n(e)},this.setNumberRange=function(t,e){if(!(e>t))throw new RangeError("maxNumber ("+e+") is not greater than minNumber ("+t+")");i=t,r=e},this.colourAt=function(e){return t(e,a.substring(0,2),o.substring(0,2))+t(e,a.substring(2,4),o.substring(2,4))+t(e,a.substring(4,6),o.substring(4,6))},formatHex=function(t){return 1===t.length?"0"+t:t}}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,s=l.call(arguments,1),d=0,u=0,h=0,f=0,m=0,v=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(h=-1*r.detail),"wheelDelta"in r&&(h=r.wheelDelta),"wheelDeltaY"in r&&(h=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*h,h=0),d=0===h?u:h,"deltaY"in r&&(h=-1*r.deltaY,d=h),"deltaX"in r&&(u=r.deltaX,0===h&&(d=-1*u)),0!==h||0!==u){if(1===r.deltaMode){var g=t.data(this,"mousewheel-line-height");d*=g,h*=g,u*=g}else if(2===r.deltaMode){var p=t.data(this,"mousewheel-page-height");d*=p,h*=p,u*=p}if(f=Math.max(Math.abs(h),Math.abs(u)),(!i||i>f)&&(i=f,a(r,f)&&(i/=40)),a(r,f)&&(d/=40,u/=40,h/=40),d=Math[d>=1?"floor":"ceil"](d/i),u=Math[u>=1?"floor":"ceil"](u/i),h=Math[h>=1?"floor":"ceil"](h/i),c.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();m=e.clientX-w.left,v=e.clientY-w.top}return e.deltaX=u,e.deltaY=h,e.deltaFactor=i,e.offsetX=m,e.offsetY=v,e.deltaMode=0,s.unshift(e,d,u,h),o&&clearTimeout(o),o=setTimeout(n,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function n(){i=null}function a(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var o,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var d=r.length;d;)t.event.fixHooks[r[--d]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=s.length;n;)this.addEventListener(s[--n],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=s.length;n;)this.removeEventListener(s[--n],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),a=n["offsetParent"in t.fn?"offsetParent":"parent"]();return a.length||(a=t("body")),parseInt(a.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){t.fn.timeline=function(e){function n(t){var e;e=p()?20+70*Math.random()+"%":10+60*Math.random()+"%",a({content:O.templateEvent.replace("[title]",t.title).replace("[date]",f(t.date)).replace("[description]",t.description).replace(/\[link\]/g,t.link).replace("[image]",t.image?'<img src="'+t.image+'"/>':""),start:t.date.start,end:t.date.end?t.date.end:t.date.start,title:t.title,offset:e},"event"+(!0===t.keyEvent?" key-event":"")+(t.image?" has-img":"")+(t.class?" "+t.class:""))}function a(e,n,a){var i,r,s,l=g(e,a),d=X;if(p()?(i="top",r="left",s="height"):(i="left",r="top",s="width"),void 0!==a&&(d=a.find("main")),null!==l[s]){if(e.$div=t("<div></div>").appendTo(d).css(i,l[i]+("left"==i?d.scrollLeft():d.scrollTop())).css(r,e.offset?e.offset:null).css(s,l[s]).data("data",e).html("<div><h2>"+e.title+"</h2>"+(e.content?"<div>"+e.content+"</div>":"")+"</div>"),n&&e.$div.addClass(n),e.class&&e.$div.addClass(e.class),e.$div.hasClass("event"))e.$div.click(k);else switch(O.colorMode){case"rainbow":e.$div.css({backgroundColor:"rainbow"==O.colorMode?E():A()});break;case"random":e.$div.css({backgroundColor:A()})}e.interval&&o(e)}}function o(e){if(e.interval){var n=O.layoutMode==j?"height":"width",a=O.layoutMode==j?"top":"left",o=t('<ul class="scale"></ul>').css(n,"width"==n?e.$div.width():e.$div.height()).appendTo(e.$div);t(e.interval).each(function(n,i){o.append(t("<li></li>").css(a,"left"==a?v(i)-e.$div.offset().left:v(i)-e.$div.offset().top).html(u(i)))})}}function i(){H.find(".event").unbind().remove(),O.data=[]}function r(t){var e=parseInt(t),n=t-e,a=e%4==0&&e%100!=0||e%400==0?366:365,o=n*a*24*60*60*1e3,i=new Date(e,0,1);return i=new Date(i.getTime()+o),{year:e,month:i.getMonth()+1,day:i.getDate()}}function s(){var e=this;return null===O.layoutMode&&(O.layoutMode=H.height()>H.width()?j:Y),H.addClass(O.layoutMode===j?"vertical":"horizontal"),H.addClass("loading"),w(),O.data&&(t(O.data).each(function(t,e){n(e)}),H.removeClass("loading")),t(O.src).each(function(t,n){setTimeout(function(){y.call(e,n)},500*t)}),this}function l(e,n){var a=!0;return t.each(["day","month","year"],function(t,o){return e[o]!=n[o]?(a=!1,void 0):void 0}),a}function d(t,e,n){var a=void 0!==t.year?t.year:t,o=void 0!==e.year?e.year:e,i=void 0!==n.year?n.year:n;return a>=o&&i>=a}function c(t){window.console&&window.console.log&&window.console.log(t)}function u(t){if(!t.year)return h(t);if(t.format)return t.format.replace("y",t.year).replace("m",O.monthNames[t.month-1]).replace("d",t.day);var e=h(t.year);return t.month&&(e=O.monthNames[t.month-1]+" "+e),t.day&&(e=t.day+" "+e),e}function h(t){var e=t;return Math.abs(t)>=1e6?e=(Math.abs(t/1e6).toFixed(1)+"m yrs").replace(".0",""):Math.abs(t)>1e4&&(e=M(Math.abs(t))),0>t&&(e+=" BC"),e}function f(t){var e=[u(t.start)];return t.end&&(l(t.start,t.end)||e.push(u(t.end))),e.join(" to ")}function m(e){var n=p()?"top":"left",a=p()?"height":"width",o={};return t(O.timescales).each(function(t,i){var s=i.$div.position()[n],l=s+i.$div[a]();if(e>=s&&s+l>=e){var d=(e-s)/(l-s),c=i.end-i.start;return o.year=i.start+c*d,o.year<1e3?o.string=u(o.year.toFixed(0)):o.year&&(o.string=u(r(o.year))),void 0}}),o}function v(e){var n,a=e.year?e.year:e,o=p()?"top":"left";return e.month&&e.day?a=365*a+30*e.month+e.day:e.month&&(a=12*a+e.month),t(O.timescales).each(function(t,i){var r=i.start,s=i.end;e.month&&e.day?(r*=365,s*=365):e.month&&(r*=12,s*=12);var l=i.width/(s-r);return a>=r&&s>a?(n=i.$div.offset()[o]+(a-r)*l,void 0):void 0}),n}function g(e,n){var a={left:null,width:0},o=O.timescales,i=e.start.year?e.start.year:e.start,r=e.end.year?e.end.year:e.end,s=p()?"top":"left";return e.start.month&&e.start.day&&(i=365*i+30*e.start.month+e.start.day,r=365*r+30*e.end.month+e.end.day),void 0!==n&&(o=[{$div:n,start:n.data("data").start,end:n.data("data").end,width:n.width()}]),t(o).each(function(t,n){var o=n.start,l=n.end;e.start.month&&e.start.day&&(o*=365,l*=365);var d=n.width/(l-o);i>=o&&l>i&&(a[s]=n.$div.position()[s]+(i-o)*d),i>l||o>r||(i>o&&l>r?a.width+=(r-i)*d:i>=o&&r>=l?a.width+=(l-i)*d:o>i&&r>l?a.width+=n.width:o>=i&&l>=r&&(a.width+=(r-o)*d))}),a}function p(){return O.layoutMode===j}function w(){R(O.layoutMode);var e=p()?"top":"left",n=p()?"height":"width";I.setNumberRange(0,O.timescales.length),O.colors&&I.setSpectrumByArray(O.colors),X=t("<main></main>").appendTo(H),t(O.timescales).each(function(a,i){O.timescales[a][e]=0===a?0:X.children().last().position()[e]+("left"===e?X.children().last().width():X.children().last().height()),O.timescales[a].$div=t('<div class="timespan"><h1>'+h(i.start)+"</h1></div>").addClass(i.class).appendTo(X).css("backgroundColor","rainbow"===O.colorMode?"#"+I.colorAt(a):E()).css(e,O.timescales[a][e]).css(n,i.width).data("data",i),o(O.timescales[a])}),t(O.periods).each(function(t,e){e.class=e.class?"period "+e.class:"period",a(e)}),O.startDate&&S(O.startDate),X.mousedown(C).keydown(x).keyup(T).mousewheel(function(t){t.preventDefault(),z(100*t.deltaY)}).attr("tabindex",1).focus().find(">div").dblclick($),t(window).resize(function(){})}function y(t){t.loadFunction&&t.url?t.loadFunction.call(this,t.url,this):O.loadFunction?O.loadFunction.call(this,t,this):b(t)}function b(e,a){H.addClass("loading"),t.ajax({dataType:"json",success:function(e){t(e).each(function(t,e){n(e)}),O.data=O.data.concat(e),H.removeClass("loading"),void 0!==a&&a()},url:e})}function M(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function C(e){var n,a,o=this;p()?(n=e.clientY,a=X.scrollTop(),X.mousemove(function(t){X.scrollTop(a-(t.clientY-n))}).mouseup(function(e){t(e.currentTarget).unbind("mousemove").unbind("mouseup")}),O.onMove.call(o)):(n=e.clientX,a=X.scrollLeft(),X.mousemove(function(t){X.scrollLeft(a-(t.clientX-n))}).mouseup(function(e){t(e.currentTarget).unbind("mousemove").unbind("mouseup")}),O.onMove.call(o))}function k(e){var n=t(e.currentTarget),a=n.closest("main"),o=n.offset().left,i=a.width()<o+n.find("h2").width(),r=a.height()/2<n.offset().top;n.removeClass("right").removeClass("bottom").toggleClass("active"),i&&n.addClass("right"),r&&n.addClass("bottom"),S(n.data("data").start)}function x(t){if(p())switch(t.keyCode){case 38:N(X.height()/4);break;case 40:N(-X.height()/4)}else switch(t.keyCode){case 37:N(X.width()/4);break;case 39:N(-X.width()/4)}}function T(t){}function D(e){var n=t(e.currentTarget).closest(".clone");t(".clone").css({left:-1+X.scrollLeft(),position:"absolute"}).animate({height:n.data("owner").height(),left:n.data("owner").offset().left+X.scrollLeft(),opacity:0,top:n.data("owner").offset().top,width:n.data("owner").width()},function(){n.remove(),H.removeClass("zoomed")})}function $(e){if(O.enableRegionExpand){t(".clone button").trigger("click");var n=t(e.currentTarget),o=n.clone(!0).css({backgroundColor:""}).attr("tabindex",1).addClass("clone").removeClass("rotate").unbind().appendTo(X).animate({height:H.height(),left:-1+X.scrollLeft(),top:0,width:H.width()+2},function(){H.addClass("zoomed"),t(this).css({left:-1,position:"fixed"}),c(O.data),t(O.data).each(function(t,e){d(e.date.start,o.data("data").start,o.data("data").end)&&a({content:O.templateEvent.replace("[title]",e.title).replace("[date]",f(e.date)).replace("[description]",e.description).replace(/\[link\]/g,e.link).replace("[image]",e.image?'<img src="'+e.image+'"/>':""),start:e.date.start,end:e.date.end?e.date.end:e.date.start,title:e.title,offset:10+50*Math.random()+"%"},"event"+(!0===e.keyEvent?" key-event":"")+(e.image?" has-img":""),o)})}).data("owner",n).append(t("<button></button>").click(D)).prepend("<main></main>").keydown(L).focus(),i=o.find("ul").width();o.find("ul").css({width:"100%"}).children().each(function(e,n){t(n).css({left:100*(t(n).position().left/i)+"%"})}),n.data("data").name&&n.data("data").start&&n.data("data").end&&(o.append('<div class="label start">'+h(n.data("data").start)+"</div>"),o.append('<div class="label end">'+h(n.data("data").end)+"</div>")),_dragging=!1}}function L(t){switch(t.keyCode){case 27:D(t)}}function A(){for(var t=[],e=0;2>=e;e++)t.push(Math.round(255*Math.random()));return"rgba("+t.join(",")+",0.5)"}function E(){return"rgba(0,0,0,"+(0+.1*Math.random())+")"}function N(t){O.layoutMode==j?X.stop().animate({scrollTop:X.scrollTop()-t}):X.stop().animate({scrollLeft:X.scrollLeft()-t}),O.onMove.call(this)}function R(t){var e=O.layoutMode;t!==j&&(t=Y),t!==e&&(c(t),_clear(),s())}function z(t){O.layoutMode==j?X.scrollTop(X.scrollTop()-t):X.scrollLeft(X.scrollLeft()-t),O.onMove.call(this)}function S(t){var e;O.layoutMode==j?(e=H.parent().width()/2-v(t),N(e)):(e=H.parent().height()/2-v(t),N(e)),O.onMove.call(this)}function F(e){var n=O._zoomFactor;O._zoomFactor=e,X.find(">div").each(function(n,a){var o=p()?{height:t(a).height()*e,top:t(a).offset().top*e,transition:"height 0.1s, top 0.1s"}:{left:t(a).offset().left*e,transition:"left 0.1s, width 0.1s",width:t(a).width()*e};t(a).css(o)}),O.onZoom.call(this,n,e)}var X,Y=0,j=1,H=t(this),I=new Rainbow,O=t.extend({colorMode:"",data:[],layoutMode:null,monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],onMove:function(){},onZoom:function(){},src:[],templateEvent:'<span class="date">[date]</span><span class="description">[image][description]</span><a href="[link]" target="_blank">More...</a>'},e);return this.each(function(){s.call(this),this.addItem=function(e){e=t.extend({title:"",description:"",date:{start:{year:null,month:null,day:null},end:{year:null,month:null,day:null}},link:"",image:"","class":"",keyEvent:!1,top:null},e),n(e),O.data.push(e)},this.clearFeatures=function(){i(this)},this.getDateAtXY=function(t,e){return p()?m(e):m(t)},this.gotoDate=function(t){S(t)},this.loadData=function(t){y.call(this,t)},this.zoom=function(t){F.call(this,t)}})}}(jQuery);
//# sourceMappingURL=timeline.min.js.map